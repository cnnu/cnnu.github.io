<!doctype html><html lang=en dir=auto><head><meta name=generator content="Hugo 0.143.1"><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>CHALNONE</title>
<meta name=keywords content="Blog,Portfolio,PaperMod,Chalnone"><meta name=description content="Chalnone"><meta name=author content="CHALNONE"><link rel=canonical href=http://cnnu.github.io/blog/><meta name=google-site-verification content="XYZabc"><meta name=yandex-verification content="XYZabc"><meta name=msvalidate.01 content="XYZabc"><link crossorigin=anonymous href=/blog/assets/css/stylesheet.fc220c15db4aef0318bbf30adc45d33d4d7c88deff3238b23eb255afdc472ca6.css integrity="sha256-/CIMFdtK7wMYu/MK3EXTPU18iN7/MjiyPrJVr9xHLKY=" rel="preload stylesheet" as=style><link rel=icon href=http://cnnu.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=http://cnnu.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=http://cnnu.github.io/favicon-32x32.png><link rel=apple-touch-icon href=http://cnnu.github.io/apple-touch-icon.png><link rel=mask-icon href=http://cnnu.github.io/blog/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate type=application/rss+xml href=http://cnnu.github.io/blog/index.xml><link rel=alternate type=application/json href=http://cnnu.github.io/blog/index.json><link rel=alternate hreflang=en href=http://cnnu.github.io/blog/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="CHALNONE"><meta property="og:description" content="Chalnone"><meta property="og:type" content="website"><meta property="og:url" content="http://cnnu.github.io/blog/"><meta property="og:image" content="http://cnnu.github.io/blog/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta property="og:site_name" content="Chalnone 's Blog"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="http://cnnu.github.io/blog/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:title content="CHALNONE"><meta name=twitter:description content="Chalnone"><script type=application/ld+json>{"@context":"https://schema.org","@type":"Organization","name":"CHALNONE","url":"http://cnnu.github.io/blog/","description":"Chalnone","thumbnailUrl":"http://cnnu.github.io/favicon.ico","sameAs":[]}</script></head><body class=list id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=http://cnnu.github.io/blog/ accesskey=h title="  (Alt + H)"><img src=http://cnnu.github.io/logo.png alt aria-label=logo height=150></a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=http://cnnu.github.io title=ä¸»é¡µ><span>ä¸»é¡µ</span>&nbsp;<svg fill="none" shape-rendering="geometricPrecision" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><path d="M15 3h6v6"/><path d="M10 14 21 3"/></svg></a></li><li><a href=http://cnnu.github.io/blog/archives title=å½’æ¡£><span>å½’æ¡£</span></a></li><li><a href=http://cnnu.github.io/blog/search/ title="æœç´¢ (Alt + /)" accesskey=/><span>æœç´¢</span></a></li><li><a href=http://cnnu.github.io/blog/tags/ title=æ ‡ç­¾><span>æ ‡ç­¾</span></a></li></ul></nav></header><main class=main><article class="first-entry home-info"><header class=entry-header><h1>Hi there ğŸ‘‹</h1></header><div class=entry-content>Welcome to my blog</div><footer class=entry-footer><div class=social-icons></div></footer></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>MF3 IC D40 ä¸­æ–‡æ‰‹å†Œ</h2></header><div class=entry-content><p>MF3 IC D40 ä¸­æ–‡æ‰‹å†Œ 1 ç‰¹æ€§ 1.1 RF æ¥å£ï¼šISO 14443 ç±»å‹ A é€šè¿‡ RF åœºå®ç°æ•°æ®éæ¥è§¦å¼ä¼ è¾“å’Œä¾›ç”µï¼ˆæ— éœ€ç”µæ± ï¼‰ æ“ä½œè·ç¦»ï¼šæœ€å¤§ 100mmï¼ˆå–å†³äºå¤©çº¿çš„å½¢çŠ¶ï¼‰ æ“ä½œé¢‘ç‡ï¼š13.56MHz å¿«é€Ÿæ•°æ®ä¼ è¾“ï¼š106kbit/sï¼Œ424kbit/s é«˜æ•°æ®å®Œæ•´æ€§ï¼š4 å­—èŠ‚ MACã€16 ä½ CRCã€å¥‡å¶æ ¡éªŒã€ä½ç¼–ç ã€ä½è®¡æ•° çœŸå®å¯ç¡®å®šçš„é˜²å†²çªæ€§ 7 å­—èŠ‚çš„å”¯ä¸€æ ‡è¯†ç¬¦ï¼ˆç¬¦åˆ ISO 14443-3 çš„çº§è”ç¬¬äºŒå±‚ï¼‰ ä½¿ç”¨ ISO 14443-4 ä¼ è¾“åè®® 1.2 éæ˜“å¤±æ€§ï¼ˆNVï¼‰å­˜å‚¨å™¨ 4k å­—èŠ‚ NV-å­˜å‚¨å™¨ NV-å­˜å‚¨å™¨å†™æ—¶é—´ 2msï¼ˆ1ms æ“¦é™¤ï¼Œ1ms ç¼–ç¨‹ï¼‰ æ•°æ®å¯ä¿å­˜ 10 å¹´ å¯å†™ 100,000 æ¬¡ 1.3 NV-å­˜å‚¨å™¨ç»„ç»‡ çµæ´»çš„æ–‡ä»¶ç³»ç»Ÿ ä¸€ä¸ª PICC æœ€å¤šå¯åŒæ—¶å­˜åœ¨ 28 ä¸ªåº”ç”¨ æ¯ä¸ªåº”ç”¨ç¨‹åºå¤šè¾¾ 16 ä¸ªæ–‡ä»¶ 1.4 å®‰å…¨æ€§ æ¯ä¸ªå™¨ä»¶æœ‰å”¯ä¸€çš„ 7 å­—èŠ‚åºåˆ—å· äº¤äº’çš„ 3 æ®µéªŒè¯ RF ä¿¡é“çš„ç¡¬ä»¶ DES/3DES æ•°æ®åŠ å¯†ï¼Œå¯é˜²æ­¢é‡æ”¾æ”»å‡» é€šè¿‡ 4 å­—èŠ‚ MAC è¿›è¡Œæ•°æ®éªŒè¯ åº”ç”¨çº§éªŒè¯ 2 æ¦‚è¿° PHILIPS å¼€å‘äº† MIFARE DESFire (MF3 IC D40) å¯ç”¨äºç¬¦åˆ ISO 14443 ç±»å‹ A çš„è¿‘è€¦åˆè®¾å¤‡ï¼ˆPCDï¼‰ã€‚ä¼ è¾“åè®®éµå¾ª ISO 14443-4 éƒ¨åˆ†ã€‚MF3 IC D40 ä¸»è¦æ˜¯ä¸ºå®‰å…¨çš„éæ¥è§¦å¼ä¼ è¾“åº”ç”¨å’Œç›¸å…³çš„ loyalty ç¨‹åºè€Œè®¾è®¡çš„ã€‚
...</p></div><footer class=entry-footer><span title='2025-02-10 14:12:47 +0800 CST'>February 10, 2025</span>&nbsp;Â·&nbsp;6 min&nbsp;Â·&nbsp;CHALNONE</footer><a class=entry-link aria-label="post link to MF3 IC D40 ä¸­æ–‡æ‰‹å†Œ" href=http://cnnu.github.io/blog/posts/desfarecaredinfo/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>SM1 åŠ è§£å¯†æ•°æ®ç¤ºä¾‹</h2></header><div class=entry-content><p>4. SM1 åŠ è§£å¯†æ•°æ®ç¤ºä¾‹ ä¸ºäº†æ–¹ä¾¿å®¢æˆ·è°ƒè¯•ï¼Œè¿™é‡Œæä¾›å‡ ç»„ SM1 åŠ è§£å¯†ç¤ºä¾‹æ•°æ®ã€‚
å¯†é’¥ è¾“å…¥æ•°æ® åŠ è§£å¯† ç»“æœ 30303030303030303030303030303030 13245768AABBCCDDECBDA89755443322 åŠ å¯† 059E0556A98F4894D457A0EC89A5CE5D 30303030303030303030303030303030 00000000000000000000000000000000 åŠ å¯† 1E5D494D6E1D2A0293BB92FC6EFD457C 30303030303030303030303030303030 11111111111111111111111111111111 åŠ å¯† 185FD3C23C0204744C3A8DBC8848FE03 30303030303030303030303030303030 22222222222222222222222222222222 åŠ å¯† D2BE9BC5F347159A22D3109A03F0E49F 30303030303030303030303030303030 33333333333333333333333333333333 åŠ å¯† 2FD8C17D3EC34DEEE1EF7EE20A15BACB 30303030303030303030303030303030 13245768AABBCCDDECBDA89755443322 è§£å¯† 47D762920590B417BEDFA9F819AA348F 30303030303030303030303030303030 00000000000000000000000000000000 è§£å¯† 0DBB978519E75586C2DD020F4D885FA5 30303030303030303030303030303030 11111111111111111111111111111111 è§£å¯† AEE86B8296B0244FB4262BF598078BEB 30303030303030303030303030303030 22222222222222222222222222222222 è§£å¯† E29BFA625BCE168E91293A1CF426730E 30303030303030303030303030303030 33333333333333333333333333333333 è§£å¯† 7FCF727B3638592F4A01FA9DAE12FE5D</p></div><footer class=entry-footer><span title='2025-02-11 10:01:17 +0800 CST'>February 11, 2025</span>&nbsp;Â·&nbsp;1 min&nbsp;Â·&nbsp;CHALNONE</footer><a class=entry-link aria-label="post link to SM1 åŠ è§£å¯†æ•°æ®ç¤ºä¾‹" href=http://cnnu.github.io/blog/posts/sm1encrypteddataexample/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>éªŒè¯åŠ å¯†èŠ¯ç‰‡èº«ä»½è®¤è¯è®¾å¤‡</h2></header><div class=entry-content><p>æµ‹è¯•æ­¥éª¤ 1. è·å–ç‰ˆæœ¬å· æè¿°ï¼šå…ˆç”¨é€šç”¨ä¸²å£è½¯ä»¶æµ‹è¯•å‘½ä»¤115200,8ï¼ŒNï¼Œ0ï¼Œè·å–ç‰ˆæœ¬å·ã€‚å¦‚æœæ­£å¸¸è¿”å›è¯´æ˜ç¡¬ä»¶æ²¡æœ‰é—®é¢˜ã€‚ å‘é€æŒ‡ä»¤ï¼š02 03 00 04 11 03 00 00 15 40 é¢„æœŸå›å¤ï¼š02 03 00 09 11 03 01 00 04 00 02 01 04 1A 40 2. å¯¹ç§°ç®—æ³•åœ¨çº¿åŠ å¯†æŒ‡ä»¤ æè¿°ï¼šåŠ å¯†èŠ¯ç‰‡å‘é€ä¸€ä¸ªå¯¹ç§°ç®—æ³•ï¼ˆSM1 ECBç®—æ³•ï¼‰åœ¨çº¿åŠ å¯†æŒ‡ä»¤åŠ å¯†æ•°æ®ã€‚ å‘é€æŒ‡ä»¤ï¼š02 0C 00 29 41 35 00 25 01 01 00 10 11 11 11 11 22 22 22 22 33 33 33 33 44 44 44 44 00 FE DC BA 98 76 54 32 10 01 23 45 67 89 AB CD EF 64 40 é¢„æœŸå›å¤ï¼š02 0C 00 15 41 35 01 00 10 49 B1 98 CA 54 5C DF B8 45 78 34 ED 63 44 6F 65 70 40 2. å¯¹ç§°ç®—æ³•åœ¨çº¿åŠ å¯†æŒ‡ä»¤ æè¿°ï¼šè·å–åŠ å¯†æ•°æ®ä¸é¢„æœŸåŠ å¯†æ•°æ®è¿›è¡Œæ¯”è¾ƒï¼Œç¬¦åˆåˆ™é€šè¿‡ï¼Œå¦åˆ™å¤±è´¥ã€‚</p></div><footer class=entry-footer><span title='2025-02-11 09:53:40 +0800 CST'>February 11, 2025</span>&nbsp;Â·&nbsp;1 min&nbsp;Â·&nbsp;CHALNONE</footer><a class=entry-link aria-label="post link to éªŒè¯åŠ å¯†èŠ¯ç‰‡èº«ä»½è®¤è¯è®¾å¤‡" href=http://cnnu.github.io/blog/posts/encryptionchipauthenticationdevice/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>MH1721åŠ å¯†èŠ¯ç‰‡è®¤è¯æµç¨‹</h2></header><div class=entry-content><p>æµ‹è¯•æ­¥éª¤ 1. è·å–ç‰ˆæœ¬å· æè¿°ï¼šå…ˆç”¨é€šç”¨ä¸²å£è½¯ä»¶æµ‹è¯•å‘½ä»¤115200,8ï¼ŒNï¼Œ0ï¼Œè·å–ç‰ˆæœ¬å·ã€‚å¦‚æœæ­£å¸¸è¿”å›è¯´æ˜ç¡¬ä»¶æ²¡æœ‰é—®é¢˜ã€‚ å‘é€æŒ‡ä»¤ï¼š02 03 00 04 11 03 00 00 15 40 é¢„æœŸå›å¤ï¼š02 03 00 09 11 03 01 00 04 00 02 01 04 1A 40 2. å†…éƒ¨éªŒè¯æŒ‡ä»¤åŠ å¯†å¯†é’¥å­—ç¬¦ä¸² æè¿°ï¼šå‘å›½å¯†CPUå¡å‘é€ä¸€ä¸ªå†…éƒ¨éªŒè¯æŒ‡ä»¤åŠ å¯†å¯†é’¥å­—ç¬¦ä¸²ã€‚ å‘é€æŒ‡ä»¤ï¼š00 88 00 00 10 11 11 11 11 22 22 22 22 33 33 33 33 44 44 44 00 é¢„æœŸå›å¤ï¼š 3. å¯¹ç§°ç®—æ³•åœ¨çº¿åŠ å¯†æŒ‡ä»¤ æè¿°ï¼šåŠ å¯†èŠ¯ç‰‡å‘é€ä¸€ä¸ªå¯¹ç§°ç®—æ³•ï¼ˆSM1 ECBç®—æ³•ï¼‰åœ¨çº¿åŠ å¯†æŒ‡ä»¤åŠ å¯†æ•°æ®ã€‚ å‘é€æŒ‡ä»¤ï¼š02 0C 00 29 41 35 00 25 01 01 00 10 11 11 11 11 22 22 22 22 33 33 33 33 44 44 44 44 00 FE DC BA 98 76 54 32 10 01 23 45 67 89 AB CD EF 64 40 é¢„æœŸå›å¤ï¼š02 0C 00 15 41 35 01 00 10 49 B1 98 CA 54 5C DF B8 45 78 34 ED 63 44 6F 65 70 40 4. éªŒè¯æ•°æ®ä¸€è‡´æ€§ æè¿°ï¼šéªŒè¯æ­¥éª¤2å’Œæ­¥éª¤3è·å–åˆ°çš„å­—ç¬¦ä¸²dataæ˜¯å¦ä¸€è‡´ï¼Œä¸€è‡´åˆ™è®¤è¯æˆåŠŸï¼Œä¸ä¸€è‡´åˆ™è®¤è¯å¤±è´¥ã€‚ ç¤ºä¾‹ä»£ç  int CCPUCardDlg::CheckM1721(unsigned char* key, unsigned char* random) { byte result1[50],result2[50], resultlen; byte commands[22] = { 0x00, 0x88, 0x00, 0x00, 0x10 }; memcpy(commands + 5, random, 16); byte cmd[2] = { 0x41,0x35 }; byte data[300] = { 0x01,0x01,0x00,0x10 }; int len = 4; memcpy(data + len, key, 16);//key len += 16; data[len] = 0x00; len += 1; memcpy(data + len, random, 16);//æ•°æ® len += 16; ExecCommand(commands, 21, result1, &amp;resultlen, true); len = cmd_M1721(cmd, data, len, result2); return memcmp(result1, result2, 16); }</p></div><footer class=entry-footer><span title='2025-02-11 09:19:03 +0800 CST'>February 11, 2025</span>&nbsp;Â·&nbsp;2 min&nbsp;Â·&nbsp;CHALNONE</footer><a class=entry-link aria-label="post link to MH1721åŠ å¯†èŠ¯ç‰‡è®¤è¯æµç¨‹" href=http://cnnu.github.io/blog/posts/encryptionchipauthentication/></a></article></main><footer class=footer><span>&copy; 2025 <a href=http://cnnu.github.io/blog/>CHALNONE</a></span> Â·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>