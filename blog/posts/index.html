<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Posts | CHALNONE</title>
<meta name=keywords content><meta name=description content="Posts - CHALNONE"><meta name=author content="CHALNONE"><link rel=canonical href=http://cnnu.github.io/blog/posts/><meta name=google-site-verification content="XYZabc"><meta name=yandex-verification content="XYZabc"><meta name=msvalidate.01 content="XYZabc"><link crossorigin=anonymous href=/blog/assets/css/stylesheet.fc220c15db4aef0318bbf30adc45d33d4d7c88deff3238b23eb255afdc472ca6.css integrity="sha256-/CIMFdtK7wMYu/MK3EXTPU18iN7/MjiyPrJVr9xHLKY=" rel="preload stylesheet" as=style><link rel=icon href=http://cnnu.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=http://cnnu.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=http://cnnu.github.io/favicon-32x32.png><link rel=apple-touch-icon href=http://cnnu.github.io/apple-touch-icon.png><link rel=mask-icon href=http://cnnu.github.io/blog/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate type=application/rss+xml href=http://cnnu.github.io/blog/posts/index.xml><link rel=alternate hreflang=en href=http://cnnu.github.io/blog/posts/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="Posts"><meta property="og:description" content="Chalnone"><meta property="og:type" content="website"><meta property="og:url" content="http://cnnu.github.io/blog/posts/"><meta property="og:image" content="http://cnnu.github.io/blog/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta property="og:site_name" content="Chalnone 's Blog"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="http://cnnu.github.io/blog/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:title content="Posts"><meta name=twitter:description content="Chalnone"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"http://cnnu.github.io/blog/posts/"}]}</script></head><body class=list id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=http://cnnu.github.io/blog/ accesskey=h title="  (Alt + H)"><img src=http://cnnu.github.io/logo.png alt aria-label=logo height=150></a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=http://cnnu.github.io title=主页><span>主页</span>&nbsp;<svg fill="none" shape-rendering="geometricPrecision" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><path d="M15 3h6v6"/><path d="M10 14 21 3"/></svg></a></li><li><a href=http://cnnu.github.io/blog/archives title=归档><span>归档</span></a></li><li><a href=http://cnnu.github.io/blog/search/ title="搜索 (Alt + /)" accesskey=/><span>搜索</span></a></li><li><a href=http://cnnu.github.io/blog/tags/ title=标签><span>标签</span></a></li></ul></nav></header><main class=main><header class=page-header><div class=breadcrumbs><a href=http://cnnu.github.io/blog/>Home</a></div><h1>Posts</h1></header><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>MF3 IC D40 中文手册</h2></header><div class=entry-content><p>MF3 IC D40 中文手册 1 特性 1.1 RF 接口：ISO 14443 类型 A 通过 RF 场实现数据非接触式传输和供电（无需电池） 操作距离：最大 100mm（取决于天线的形状） 操作频率：13.56MHz 快速数据传输：106kbit/s，424kbit/s 高数据完整性：4 字节 MAC、16 位 CRC、奇偶校验、位编码、位计数 真实可确定的防冲突性 7 字节的唯一标识符（符合 ISO 14443-3 的级联第二层） 使用 ISO 14443-4 传输协议 1.2 非易失性（NV）存储器 4k 字节 NV-存储器 NV-存储器写时间 2ms（1ms 擦除，1ms 编程） 数据可保存 10 年 可写 100,000 次 1.3 NV-存储器组织 灵活的文件系统 一个 PICC 最多可同时存在 28 个应用 每个应用程序多达 16 个文件 1.4 安全性 每个器件有唯一的 7 字节序列号 交互的 3 段验证 RF 信道的硬件 DES/3DES 数据加密，可防止重放攻击 通过 4 字节 MAC 进行数据验证 应用级验证 2 概述 PHILIPS 开发了 MIFARE DESFire (MF3 IC D40) 可用于符合 ISO 14443 类型 A 的近耦合设备（PCD）。传输协议遵循 ISO 14443-4 部分。MF3 IC D40 主要是为安全的非接触式传输应用和相关的 loyalty 程序而设计的。
...</p></div><footer class=entry-footer><span title='2025-02-10 14:12:47 +0800 CST'>February 10, 2025</span>&nbsp;·&nbsp;6 min&nbsp;·&nbsp;CHALNONE</footer><a class=entry-link aria-label="post link to MF3 IC D40 中文手册" href=http://cnnu.github.io/blog/posts/desfarecaredinfo/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>SM1 加解密数据示例</h2></header><div class=entry-content><p>4. SM1 加解密数据示例 为了方便客户调试，这里提供几组 SM1 加解密示例数据。
密钥 输入数据 加解密 结果 30303030303030303030303030303030 13245768AABBCCDDECBDA89755443322 加密 059E0556A98F4894D457A0EC89A5CE5D 30303030303030303030303030303030 00000000000000000000000000000000 加密 1E5D494D6E1D2A0293BB92FC6EFD457C 30303030303030303030303030303030 11111111111111111111111111111111 加密 185FD3C23C0204744C3A8DBC8848FE03 30303030303030303030303030303030 22222222222222222222222222222222 加密 D2BE9BC5F347159A22D3109A03F0E49F 30303030303030303030303030303030 33333333333333333333333333333333 加密 2FD8C17D3EC34DEEE1EF7EE20A15BACB 30303030303030303030303030303030 13245768AABBCCDDECBDA89755443322 解密 47D762920590B417BEDFA9F819AA348F 30303030303030303030303030303030 00000000000000000000000000000000 解密 0DBB978519E75586C2DD020F4D885FA5 30303030303030303030303030303030 11111111111111111111111111111111 解密 AEE86B8296B0244FB4262BF598078BEB 30303030303030303030303030303030 22222222222222222222222222222222 解密 E29BFA625BCE168E91293A1CF426730E 30303030303030303030303030303030 33333333333333333333333333333333 解密 7FCF727B3638592F4A01FA9DAE12FE5D</p></div><footer class=entry-footer><span title='2025-02-11 10:01:17 +0800 CST'>February 11, 2025</span>&nbsp;·&nbsp;1 min&nbsp;·&nbsp;CHALNONE</footer><a class=entry-link aria-label="post link to SM1 加解密数据示例" href=http://cnnu.github.io/blog/posts/sm1encrypteddataexample/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>验证加密芯片身份认证设备</h2></header><div class=entry-content><p>测试步骤 1. 获取版本号 描述：先用通用串口软件测试命令115200,8，N，0，获取版本号。如果正常返回说明硬件没有问题。 发送指令：02 03 00 04 11 03 00 00 15 40 预期回复：02 03 00 09 11 03 01 00 04 00 02 01 04 1A 40 2. 对称算法在线加密指令 描述：加密芯片发送一个对称算法（SM1 ECB算法）在线加密指令加密数据。 发送指令：02 0C 00 29 41 35 00 25 01 01 00 10 11 11 11 11 22 22 22 22 33 33 33 33 44 44 44 44 00 FE DC BA 98 76 54 32 10 01 23 45 67 89 AB CD EF 64 40 预期回复：02 0C 00 15 41 35 01 00 10 49 B1 98 CA 54 5C DF B8 45 78 34 ED 63 44 6F 65 70 40 2. 对称算法在线加密指令 描述：获取加密数据与预期加密数据进行比较，符合则通过，否则失败。</p></div><footer class=entry-footer><span title='2025-02-11 09:53:40 +0800 CST'>February 11, 2025</span>&nbsp;·&nbsp;1 min&nbsp;·&nbsp;CHALNONE</footer><a class=entry-link aria-label="post link to 验证加密芯片身份认证设备" href=http://cnnu.github.io/blog/posts/encryptionchipauthenticationdevice/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>MH1721加密芯片认证流程</h2></header><div class=entry-content><p>测试步骤 1. 获取版本号 描述：先用通用串口软件测试命令115200,8，N，0，获取版本号。如果正常返回说明硬件没有问题。 发送指令：02 03 00 04 11 03 00 00 15 40 预期回复：02 03 00 09 11 03 01 00 04 00 02 01 04 1A 40 2. 内部验证指令加密密钥字符串 描述：向国密CPU卡发送一个内部验证指令加密密钥字符串。 发送指令：00 88 00 00 10 11 11 11 11 22 22 22 22 33 33 33 33 44 44 44 00 预期回复： 3. 对称算法在线加密指令 描述：加密芯片发送一个对称算法（SM1 ECB算法）在线加密指令加密数据。 发送指令：02 0C 00 29 41 35 00 25 01 01 00 10 11 11 11 11 22 22 22 22 33 33 33 33 44 44 44 44 00 FE DC BA 98 76 54 32 10 01 23 45 67 89 AB CD EF 64 40 预期回复：02 0C 00 15 41 35 01 00 10 49 B1 98 CA 54 5C DF B8 45 78 34 ED 63 44 6F 65 70 40 4. 验证数据一致性 描述：验证步骤2和步骤3获取到的字符串data是否一致，一致则认证成功，不一致则认证失败。 示例代码 int CCPUCardDlg::CheckM1721(unsigned char* key, unsigned char* random) { byte result1[50],result2[50], resultlen; byte commands[22] = { 0x00, 0x88, 0x00, 0x00, 0x10 }; memcpy(commands + 5, random, 16); byte cmd[2] = { 0x41,0x35 }; byte data[300] = { 0x01,0x01,0x00,0x10 }; int len = 4; memcpy(data + len, key, 16);//key len += 16; data[len] = 0x00; len += 1; memcpy(data + len, random, 16);//数据 len += 16; ExecCommand(commands, 21, result1, &amp;resultlen, true); len = cmd_M1721(cmd, data, len, result2); return memcmp(result1, result2, 16); }</p></div><footer class=entry-footer><span title='2025-02-11 09:19:03 +0800 CST'>February 11, 2025</span>&nbsp;·&nbsp;2 min&nbsp;·&nbsp;CHALNONE</footer><a class=entry-link aria-label="post link to MH1721加密芯片认证流程" href=http://cnnu.github.io/blog/posts/encryptionchipauthentication/></a></article></main><footer class=footer><span>&copy; 2025 <a href=http://cnnu.github.io/blog/>CHALNONE</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>